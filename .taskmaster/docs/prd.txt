# 빗썸 API 기반 자동매매 시스템 백엔드 PRD

## 프로젝트 개요
빗썸 API를 활용한 암호화폐 자동매매 시스템 백엔드를 개발합니다. 사용자가 선택한 투자 방식(스캘핑/데이트레이딩/스윙/장기투자)에 따라 자동으로 거래를 수행하며, 유명 트레이더들의 검증된 전략 패턴을 구현합니다.

## 기술 스택
- **언어**: Python 3.11+ (비동기 처리 및 데이터 분석 우수)
- **프레임워크**: FastAPI (고성능 비동기 API)
- **데이터베이스**: 
  - PostgreSQL (거래 내역, 사용자 정보)
  - Redis (실시간 시세 캐싱, 세션 관리)
  - TimescaleDB (시계열 데이터 최적화)
- **메시지 큐**: Celery + RabbitMQ (비동기 작업 처리)
- **모니터링**: Prometheus + Grafana
- **로깅**: ELK Stack (Elasticsearch, Logstash, Kibana)

## 핵심 기능 명세

### 1. 빗썸 API 클라이언트 구현
- **Public API**: 현재가 정보, 호가 정보, 체결 내역, 캔들 데이터 조회
- **Private API**: 잔고 조회, 주문하기/취소, 주문조회, 체결내역 (HMAC-SHA512 서명)
- **WebSocket**: 실시간 체결, 호가, 현재가 스트리밍
- **에러 핸들링**: Rate Limit 처리, API 키 검증, 네트워크 오류 재시도
- **보안**: API Key/Secret 환경변수 관리, 데이터베이스 암호화 저장

### 2. 기술적 분석 엔진
- **이동평균선**: EMA(8,13,21,50,200), SMA(20,50,100,200), VWAP
- **오실레이터**: RSI(14), Stochastic(14,3,3), MACD(12,26,9), CCI(20)
- **변동성 지표**: Bollinger Bands(20,2), ATR(14), Keltner Channel
- **볼륨 분석**: Volume Profile, OBV, Volume MA
- **패턴 인식**: 반전/지속 패턴, 캔들 패턴, 지지/저항선 자동 감지
- **피보나치**: Retracement(23.6%, 38.2%, 50%, 61.8%, 78.6%), Extension
- **다중 시간프레임**: H1 트렌드 확인 → M15/M5 진입점 포착

### 3. 전략 엔진 구현
#### 스캘핑 전략 (Paul Rotter 스타일)
- 1-5분 차트 분석, EMA 21,13,8 조합
- 지난 5개 캔들 최고가/최저가 기준 3pip 대기주문
- 95% 승률 목표, 빠른 손절, VWAP 기준 매매

#### 데이 트레이딩 전략
- Bull Flag 패턴 인식, Gap Trading, Pivot Point 계산
- H1 트렌드 + M15 진입, RSI, MACD 종합 신호

#### 스윙 트레이딩 전략
- 피보나치 되돌림(38.2%, 50%, 61.8%), MA Crossover
- 지지/저항 반등 거래, Cup & Handle 패턴, 3일-6주 보유

#### 장기투자 전략
- DCA(Dollar Cost Averaging), 정기 리밸런싱(월 1회)
- 200일 이동평균 기준, 포트폴리오 분산

### 4. 리스크 관리 시스템
- **Position Sizing**: 계좌의 1-2%만 위험에 노출, Kelly Criterion 적용
- **Stop Loss 관리**: 가격/ATR 기반 손절, Trailing Stop Loss, 시간 기반 손절
- **Take Profit 관리**: 고정/부분 익절, 지지/저항 기반 익절, Trailing Take Profit
- **포트폴리오 리스크**: 총 리스크 한도(계좌의 10% 이하), 코인별 최대 비중 제한
- **긴급 종료**: 일일 손실 한도(-5%), 연속 손실 제한(3회), 시장 급락 감지
- **모니터링**: 포지션 진입/청산 알림, 손익률 실시간 모니터링, 일일 리포트

### 5. 데이터 수집 및 저장
- **실시간 데이터**: WebSocket 스트리밍, Redis 캐싱
- **캔들 데이터**: 1분/5분/15분/1시간/일봉 수집, TimescaleDB 저장
- **기술적 지표**: 주요 지표 사전 계산, 백테스팅용 과거 데이터 정제
- **거래 내역**: 모든 주문 내역 PostgreSQL 저장, 전략별 성과 추적

### 6. API 엔드포인트
- **인증**: 회원가입, 로그인, 빗썸 API 키 등록
- **시장 데이터**: 전체 코인 시세, 호가창, 캔들 데이터
- **전략 관리**: 전략 생성/시작/중지/삭제, 전략 목록
- **포트폴리오**: 잔고 조회, 현재 포지션, 거래 내역, 성과 분석
- **주문 관리**: 활성 주문, 주문 내역, 주문 취소
- **백테스팅**: 백테스팅 실행, 결과 조회
- **모니터링**: 대시보드 데이터, 거래 로그

### 7. 백테스팅 시스템
- **시뮬레이션**: 특정 기간 선택, 초기 자본 설정, 수수료 반영(0.25%), 슬리피지
- **성과 지표**: 총/연간 수익률, 최대 낙폭(MDD), 샤프/소르티노 비율, 승률, 평균 손익비
- **시각화**: 자산 곡선, 낙폭 차트, 거래 타이밍, 월별 수익률 히트맵
- **최적화**: 파라미터 그리드 서치, Walk-forward 분석, 과최적화 방지

### 8. 보안 및 성능 최적화
- **보안**: API 키 AES-256 암호화, JWT 인증, Rate Limiting, CORS 설정
- **성능**: Redis 캐싱, DB 커넥션 풀링, 비동기 I/O, 백그라운드 작업 큐잉

## 개발 우선순위

### Phase 1 (주 1-2): 기반 구축
- 빗썸 API 클라이언트 구현
- 데이터베이스 스키마 설계
- 실시간 데이터 수집 파이프라인
- 기술적 지표 라이브러리

### Phase 2 (주 3-4): 전략 엔진
- 스캘핑 전략 구현 (Paul Rotter)
- 데이 트레이딩 전략 구현
- 리스크 관리 시스템
- 주문 실행 로직

### Phase 3 (주 5-6): 고급 기능
- 스윙/장기투자 전략
- 백테스팅 시스템
- 포트폴리오 관리
- 성과 분석 대시보드

### Phase 4 (주 7-8): 안정화
- 에러 핸들링 강화
- 모니터링 시스템
- 알림 시스템 (Telegram)
- 부하 테스트 및 최적화

## 성공 지표
- 시스템 안정성: 99.9% 가동률
- 거래 성능: 평균 응답시간 100ms 이하
- 수익성: 백테스팅 승률 60% 이상
- 사용자 만족도: 직관적인 API 및 대시보드
- 보안: API 키 암호화 및 안전한 거래 실행
